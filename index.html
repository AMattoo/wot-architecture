<!DOCTYPE html>
<html  lang="en"  xmlns="http://www.w3.org/1999/xhtml">
  <!--
	TODOs:	* fix href for document location such https://github.com/w3c/wotwg/blob/master/architecture/wot-architectiure.html-->
  <head>
    <meta  charset="utf-8" />
    <title>Web of Things (WoT) Architecture</title>
    <script  class="remove"  async=""  src="https://www.w3.org/Tools/respec/respec-w3c-common"></script>
    <script  class="remove">
		  var respecConfig = {
			  specStatus:   "ED"
			  ,   editors:      [{name:"Kazuo Kajimoto"}, {name:"Uday Davuluru"}]
			  ,   authors:      [{name:"Kazuo Kajimoto"}, {name:"Ryuichi Matsukura"}, {name:"Johannes Hund"}, {name:"Matthisas Kovatsch"}, {name:"Kazuaki Nimura"}]
			  ,   processVersion: 2015
			  ,   shortName:    "wot-arch"
			  , wg:           "Web of Things Working Group"
			  , wgURI:        "http://www.w3.org/WoT/WG/"
			  , wgPublicList: "public-wot-wg"
			  , otherLinks: [
				{
				 key: "GitHub",
				 data: [
				   {
					 value: "Master branch on GitHub",
					 href: "https://github.com/w3c/wot-architecture/blob/master/"
				   }, {
					value: "File a bug",
					href: "https://github.com/w3c/wot-architecture/issues"
				   }, {
					value: "Contribute",
					href: "https://github.com/w3c/wot-architecture/edit/master/"
				   }
				  ]
				}
			   ]
			};
		</script>
  </head>
  <body>
    <section  id="abstract">
      <p> This document describes architecture on Web of Things which derived from use cases.<br />
      The architecture consists of building blocks and the function of each block is explained.<br />
      And it is also described how to map the WoT architecture to the wide variety of real implementation patterns.<br />
      <br />
      This document focused on the standardization scope of Web of Things.<br />
      And other blocks and conditions underlying the Web of Things are described as example implementation and/or requirements such as the description of how to treat constraint devices and security and privacy.<br />
      Web of Things is distributed platform over the latest Web technology. And Web of Things can wrap the difference among legacy IoT protocols defined by various standardizing organizations and also can provide interoperability between above legacy standards.<br />
      Utilizing this interoperability, IoT application developers can ship only one wot-compliant application on behalf of shipping each legacy standard-compliant application.</p>
    </section>
    <section  id="sotd">
      <p>Through the discussion in WoT IG, This document is reflected the conclusion for the scope of standardization in WoT WG, that is, "Thing Description", "Scripting API" and "Binding Template".<br />
      And this document also describes informative information such as implementation which covers very wide variety of systems and requirements for security and privacy. All of them are touched in WoT WG Charter. </p>
      <p  title="Contributing"  class="note"> Please contribute using <a  href="https://github.com/w3c/wotwg/blob/master/architecture/wot-architecture.html">Git</a>
        or the <a  href="https://github.com/w3c/wotwg/edit/master/architecture/wot-architecture.html">GitHub
          edit feature</a>. </p>
    </section>
    <section>
      <h1>Introduction</h1>
      <p>This document describes the abstract architecture of the “Web Of
        Things”, which we will also refer to with the acronym "WoT".
        The purpose of this document is to provide
        <ol type="a">
        <li>a guideline to the mapping between functional architecture and
        physical devices configuration,</li>
        <li>a description of the role and functionality of each logical module,</li>
        <li>a reference defining what should be standardized,</li>
        <li>a set of requirements for a WoT implementation environment.</li>
        </ol>
    </section>
    <section>
      <h2>Terminology</h2>
      <p>This document uses the following terms defined elsewhere.
         The WoT prefix is used to avoid ambiguity for terms that are defined specifically for Web of Things concepts.</p>
      <dl>
        <dt> <dfn  id="CoAP">CoAP</dfn> </dt>
        <dd>Acronym for Constrained Application Protocol [[!RFC7252]]</dd>
        <dt> <dfn  id="WoTThingDescription">WoT Thing Description</dfn> </dt>
        <dd>Structured data describing a physical device or software service (WoT Thing), including metadata, links to vocabulary, a list of supported interactions, and protocol bindings for each interaction.</dd>
        <dt> <dfn  id="WoTThing">WoT Thing</dfn> </dt>
        <dd>An entity (either a physical device or a software service) whose metadata and interfaces are described by a WoT Thing Description.</dd> 
        <dt> <dfn  id="WoTServer">WoT Server</dfn> </dt>
        <dd>An entity that exposes a network interface consistent with a WoT Thing Description.  A WoT Server is a type of WoT Thing.</dd>
        <dt> <dfn  id="WoTClient">WoT Client</dfn> </dt>
        <dd>An entity that can connect with ("consume") a network interface described by a WoT Thing Description.</dd>
        <dt> <dfn  id="WoTServient">WoT Servient</dfn> </dt>
        <dd>An entity that can act either as a WoT Client or as a WoT Server (or both), eg that can both expose and consume Thing Descriptions.  
            Since a WoT Servient is also a WoT Server, it is also a WoT Thing.</dd>
        <dt> <dfn  id="LocalDiscovery">Local Discovery</dfn> </dt>
        <dd>A discovery method which can discover entities in local networks (e.g. SSDP, mDNS/DNS-SD, ...).</dd>
        <dt> <dfn  id="NearbyDiscovery">Nearby Discovery</dfn> </dt>
        <dd>A discovery method where the physical location is considered (BLE, Audio Watermarking, ...).</dd>
        <dt> <dfn  id="RemoteDiscovery">Remote Discovery</dfn> </dt>
        <dd>A discovery method which supports lookup of remote servies, for instance by using a directory service. The end point of the directory must be supported.</dd>
        <dt> <dfn  id="Client API">Client API</dfn> </dt>
        <dd>Programming interface that allows scripts to access either a WoT Client or directly attached hardware through a Physical API depending on the discovery.</dd>
        <dt> <dfn  id="Server API">Server API</dfn> </dt>
        <dd>Programming interface that allows scripts to access WoT Server.</dd>
	<dt> <dfn  id="Discovery API">Discovery API</dfn> </dt>
        <dd>Programming interface that allows scripts to discover other WoT Things.</dd>
        <!-- Add other as needed -->
      </dl>
    </section>
    <section>
      <h1>Requirements for Functional Architecture</h1>
      <p>
      This section defines the properties required in a Web of Things (WoT) abstract architecture.
      </p>
      <section>
        <h2>Flexibility</h2>
        <p>There are a wide variety of physical device configurations for WoT
          implementations.
          The WoT abstract architecture should be able to be mapped to and cover
          all of the variations.</p>
      </section>
      <section>
        <h2>Compatibility</h2>
        <p> We already have many existing IoT solutions and ongoing IoT
          standardization activities in many business fields.
          The WoT should provide a bridge between these existing and developing IoT
          solutions and Web technology based on WoT concepts. 
          The WoT should be upwards compatible with existing IoT solutions and current
          standards.<br />
        </p>
      </section>
      <section>
        <h2>Security and Privacy</h2>
        <p> Functional WoT architecture should have the room for providing
          security and privacy functionalities.<br />
          In the IoT solutions, once cyber security barrier is hacked, it is more easily led to safety and/or privacy issues than conventional web solutions. That is because hacked IoT devices often treat heat cycle such as central heating systems, physical moving devices such as cars.<br />
        </p>
      </section>
    </section>
    <section>
      <h1>General Description of WoT Servient</h1>
      <!-- Is Servient the same as Thing or different?  In the following, "Thing" is used without first being defined.
           Also it's not clear that "Servient" is the same as "Architecture".   There might be other components of the
           WoT architecture not given. -->
      <p>In the Web of Things (WoT) abstract architecture, 
        we use the term “Servient” to refer to a functional virtual device that provides access to
        IoT physical devices, including the ability to control and query the status of such devices.
        <!-- following is new, to discuss! Does "Servient" include "existing devices" or not? Does Thing == Servient, or is Servient a subclass of Thing? -->
        The word "Servient" refers to the fact that such devices may take the role of either client or server, or both. 
        The term "Thing" refers to any device or service which can be described with a WoT Thing Description.
        This can include existing devices or devices implemented under other standards (eg OCF) 
        but provided with a Thing Description as well as WoT Servients 
        implemented using the functional architecture described here.
        <!-- comment: "devices and services", since we might have a Servient that does not map onto a physical device, eg a bridge, fog compute service, etc?? -->
        The WoT Servient functional architecture is presented in Fig.1</p>
      <div  style="text-align: center;"><img  title="Functional Architecture of WoT Servient"

           alt="Functional Architecture of WoT Servient"  src="images/functional_architecture2.png"

           style="width: 640px;" /><br />
        <p>Fig.1 Functional Architecture of WoT Servient</p>
        <p  style="text-align: left;">The role and functionality of each module
          reference by the WoT Servient diagram is defined as follows:</p>
      </div>
      <section>
        <h2>Thing Description</h2>
        <p>Metadata and declarations of Thing’s capabilities (e.g., possible interactions).
             Links to the definition of different machine-understandable vocabulary sets 
             and defines protocol bindings and serialization formats.
        </p>
      </section>
      <section>
        <h2>Scripting API</h2>
        <p>APIs to provide the functionality of a Servient.
       Scripting APISs can be classified into 4 categories as follows:
       <ol type="1">
       <li>Client API which supports consuming Things</li>
       <li>Server API which supports exposing Things</li>
       <li>Discovery API which supports abstract method to access discovery mechanism</li>
       <li>Security API which supports authentication, authorization and secure communications</li>
       </ol>
       In practice the "Security API" is not independent from the other APIs.
       It is included as a component of the other APIs.
       </p>
      </section>
      <section>
        <h2>Binding Templates</h2>
        <p>Standard binding templates for the most common protocols.
        Supported transfer communication patterns include request-response, pub-sub, and bi-directional messaging. 
        In particular REST-based protocols such as HTTP and CoAP are supported, as well as pub-sub protocols such as MQTT 
        and raw channel-based protocols such as WebSockets.
        </p>
        <p>Binding Templates are used in the Protocol Binding block of the Thing Description.
        The Protocol Binding block consists of a common upper part and binding template part and as described in Fig.2</p>
      <div  style="text-align: center;"><img  title="Protocol Binding structure"

           alt="Functional Architecture of WoT Servient"  src="images/protocol-binding-concept.png"

           style="width: 640px;" /><br />
        <p>Fig.2 Protocol Binding Structure</p>
      </div>
      <section>
        <p  style="text-align: left;">The data flow of protocol binding is as follows,
		and is mainly described from the point of view of a WoT client:
                <ol type="1">
		<li>The Application Logic running in a WoT device acting as a client refers to the TD (Thing Description) of another WoT device acting as a server. 
                    Using the TD, the client's Application Logic can understand the API provided by the server.</li>
		<li>If using the Scripting API, the application logic running in the client calls the WoT runtime according to the syntax described in the Scripting API document.</li>
		<li>The Runtime block calls the Protocol Binding Common block with the type of request, that is, "Property", "Action" or "Event", and provides appropriate parameters.</li>
		<li>The Protocol Binding Common block refers TD of requested WoT device. And Protocol Binding Common block understands 
                    <ol type="a">
                    <li>what standardization organization's protocol syntax is supported by the WoT server,</li>
                    <li>what kind of transport protocol is supported by the WoT server,</li>
                    <li>what kind of serialization scheme is supported by the WoT server,</li>
                    <li>what kind of security mechanisms are supported by (or required by) the WoT server.</li>
                    </ol>
		</li>
		<li>The Protocol Binding Common block selects the proper binding template to communicate to the WoT server.
                For example, it might be an OCF device, a oneM2M device, or some other kind of device.</li>
		<li>The Binding template block creates a data payload according to its definition and communicates to the WoT server.</li>
                </ol>
	      </p>
      </section>
      <section>
        <h2>Security and Privacy</h2>
        <p>Cross-cutting mechanism for security and privacy over Thing Description, Scripting API and Protocol Bindings <br />
Thing Description and Scripting API will support both transport and object security using  best practices.
Binding Templates will support the use of appropriate for the protocols they map to.
It includes requirements of network and web-based technologies for implementation.
</p>
      </section>
      <section>
        <h2>Local Hardware</h2>
        <p>A Thing's implementation may access local hardware or services (e.g. storage) through proprietary APIs or other means. 
           This block is out of scope of WoT standardization.
           Application logic running in a WoT Runtime may also access local hardware via the Scripting API as if it were a Thing accessible over a network protocol.
           In this case the implementation should be optimized to avoid the overhead that would be involved in a literal implementation
           of a network protocol while maintaining a consistent Thing interface.
           Such "System Things" are out of the scope of standardization at present although we will document several 
           informational examples. 
        </p>
      </section>
      <section>
        <h2>Legacy Communication</h2>
        <p>A device may be physically external to a WoT Servient but connected to the WoT Servient via legacy IoT protocols, 
           In this case the implemented runtime environment may access Legacy Communication protocols such as Echonet Lite, I2C, SPI, and so on through proprietary APIs.
           In particular, constrained devices such as simple sensors with low speed CPUs may be accessed through simple protocols by a gateway which has higher spec resources.
           In this case a WoT Servient for the sensors can be implemented in a gateway on behalf of such external hardware by utilizing a Legacy Communication block.
           This should only be done if the Legacy Protocol cannot be described using a Thing Description.
           This block is out of scope of WoT standardization,
           but will sometimes be touched upon during discussion of implementation practices and/or liaisons with other W3C WG and SDOs.
        </p>
      </section>
      <section>
        <h2>App Script</h2>
        <p>As client and/or Server, application logic is implemented in an App Script using the WoT Scripting API.
           As noted, proprietary APIs may be used to access local hardware or legacy communication.</p>
      </section>
    </section>
    <section>
        <h1>Deployment Scenarios</h1>
        <p  style="text-align: left;">Scenarios utilizing WoT Servient, WoT Server and WoT Client are shown in this section. 
        Each of the scenarios also has explanation of how discovery and Scripting APIs work in these contexts.</p>
      <section>
        <h2>WoT Server on a Device</h2>
        <p  style="text-align: left;">The first example is a WoT server on an actual endpoint device as depicted in Fig.3.
         For example, an electronic appliance such as an air conditioner with web server functionality might be connected directly to a local home network.
         In this case, a remote controller with a WoT client can be realized by a browser application or native application.
         This remote controller WoT client can then access the air conditioner through the local home network directly.
       </p>
        <div  style="text-align: center;"><img  src="images/wot_server_on_device.png"  alt="wot_device"

             title="WoT server on device"  style="width: 500px;" /></div>
        <p  style="text-align: center;">Fig.3 WoT server on device</p>
        <p  style="text-align: left;">
         <dl>
         <dt>Discovery:</dt><dd>
           <ul>
           <li>WoT Client discovers WoT Servient locally [Local discovery].</li>
           </ul>
         </dd>
         <dt>APIs:</dt><dd>
           <ul>
           <li>WoT Server defines and exposes a Server API via a WoT Thing Description.</li>
           <li>Script in WoT Client accesses WoT Server (via a Client API) using interactions defined by the server's WoT Thing Description.</li>
           <li>Client API connects to WoT Server via a specific application and transport protocol (eg OCF over CoAP over UDP over IP).</li>
           </ul>
         </dd>
         </dl>
       </p>      </section>
      <section>
        <h2>WoT Client on Smartphone</h2>
        <p  style="text-align: left;">The second example is a WoT Client on a Smartphone as shown in Fig.4.
For example, a browser on smartphone can be expanded to include WoT Client functionality that can directly or remotely control an air conditioner depending on the network.
Wi-Fi or Bluetooth/BLE connection of the smartphone is used for the direct (local) control while the cellular network of the smartphone can be used for remote control.
        </p>
        <div  style="text-align: center;"><img  src="images/wot_client_on_smartphone.png"  alt="smartphone"

             title="WoT client on Smartphone"  style="width: 500px;" /></div>
        <p  style="text-align: center;">Fig.4 WoT client on Smartphone</p>
        <p  style="text-align: left;">
         <dl>
         <dt>Discovery:</dt><dd>
           <ul>
           <li>WoT Client discovers an electronic appliance when the remote controller is nearby [nearby discovery].</li>
           <li>WoT Client discovers WoT Servient remotely when the remote controller is outside [remote discovery].</li>
           </ul>
         </dd>
         <dt>APIs</dt><dd>
           <ul>
           <li>Script on WoT client accesses electronic appliances nearby with Client API through local interface when possible.</li>
           <li>WoT Servient exposes Server API.</li>
           <li>Client API connects to WoT Server via a specific application and transport protocol (eg OCF over CoAP over UDP over IP) when remote access is needed.</li>
           </ul>
         </dd>
         </dl>
       </p>
      </section>
      <section>
        <h2>WoT Servient on Smart Home Hub</h2>
        <p  style="text-align: left;">Fig.5 shows an example of WoT Servient on a smart home hub.
In this case, a home hub with WoT Servient is placed between a home network and the internet.  The home hub manages electronic appliances in a house. The home hub controls the electronic appliances when remotely receiving a command from a remote controller with WoT Client such as browser application or native application on a smartphone.
        </p>
        <div  style="text-align: center;"><img  src="images/wot_servient_on_homehub.png"  alt="homehub1"

             title="WoT Servient on Smart Home Hub"  style="width: 640px;" /></div>
        <p  style="text-align: center;">Fig.5 WoT Servient on Smart Home Hub</p>
        <p  style="text-align: left;">
         <dl>
         <dt>Discovery:</dt><dd>
           <ul>
           <li>WoT Servient discovers electronic appliances nearby [nearby discovery].</li>
           <li>WoT Client discovers WoT Servient remotely [remote discovery].</li>
           </ul>
         </dd>
         <dt>APIs</dt><dd>
           <ul>
           <li>WoT Servient exposes a Server API and consumes a Client API.
           The Client API in the WoT Servient allows scripts running in the WoT Servient's runtime to access electronic 
           appliances through a physical interface.</li>
           <li>Client API in WoT Client is used to connect to the WoT Servient via a specific application and transport protocol (eg OCF over CoAP over UDP over IP) when needed.</li>
           </ul>
         </dd>
         </dl>
       </p>
      </section>
      <section>
        <h2>WoT Servient on Cloud Server</h2>
        <p  style="text-align: left;">Use of a WoT Servient on a Cloud Server has several variants as follows.</p>
       <section>
        <h3>Smart Home: WoT Device</h3>
        <p  style="text-align: left;">Fig.6 shows an example of WoT Servient on a cloud server that shadows a WoT device.
A WoT Servient running in the cloud serves as device shadow of an electrical appliance. In this case the WoT Servient controls the appliances when receiving commands from a WoT Client such as a browser or an application on a smartphone.
        </p>
        <div  style="text-align: center;"><img  src="images/wot_servient_on_cloudserver1.png"  alt="wot_servient_on_cloudserver1"

             title="WoT servient on Cloud Server controls WoT device"  style="width: 640px;" /></div>
        <p  style="text-align: center;">Fig.6 WoT Servient on Cloud Server controls WoT device</p>
        <p  style="text-align: left;">
         <dl>
         <dt>Discovery:</dt><dd>
           <ul>
           <li>WoT Servient discovers WoT Server remotely [remote discovery].</li>
           <li>WoT Client discovers WoT Servient remotely [remote discovery].</li>
           </ul>
         </dd>
         <dt>APIs</dt><dd>
           <ul>
           <li>WoT Servient exposes Server API and Client API.
           The Client API in WoT Servient allows script to access WoT Server through IP based network.</li>
           <li>WoT Server exposes Server API.</li>
           <li>Client API in WoT Client accesses WoT Servient with REST or Client API through IP-based network.</li>
           </ul>
         </dd>
         </dl>
       </p>
       </section>
       <section>
        <h3>Smart home: Legacy device</h3>
        <p  style="text-align: left;">Fig.7 shows an example of a WoT Servient on a cloud server that controls a legacy electronic appliance through a home hub.
In this case, a WoT Servient running in the cloud caches properties of electric appliances that a home hub manages and acts as an agent that manages them in the cloud in conjunction with the home hub. 
        </p>
        <div  style="text-align: center;"><img  src="images/wot_servient_on_cloudserver2.png"  alt="wot_servient_on_cloudserver2"
             title="WoT servient on Cloud Server "  style="width: 640px;" /></div>
        <p  style="text-align: center;">Fig.7 WoT Servient on Cloud Server controls legacy device</p>
        <p  style="text-align: left;">
         <dl>
         <dt>Discovery:</dt><dd>
           <ul>
           <li>WoT Servient1 discovers WoT Servient2 remotely [remote discovery].</li>
           <li>WoT Servient2 discovers electronic appliances nearby [nearby discovery].</li>
           <li>WoT Client discovers WoT Servient1 remotely [remote discovery].</li>         
           </ul>
         </dd>
         <dt>APIs</dt><dd>
           <ul>
           <li>WoT Servient1 exposes Server API and Client API.
           The Client API in WoT Servient1 allows script to access WoT Servient2 
           through IP based network.</li>
           <li>WoT Servient2 exposes Server API and Client API.
           The Client API in WoT Servient2 allows script to access electronic 
           appliances through a local physical interface.</li>
           <li>Client API in WoT Client accesses WoT Servient1 with REST or 
           Client API through IP-based network.</li>
         </ul>
         </dd>
         </dl>
       </p>
       </section>
       <section>
        <h3>Smart Factory</h3>
        <p  style="text-align: left;">Fig.8 shows an example of a Smart Factory that uses WoT Servients.
In this case, WoT Servient 1 and WoT Servient 2 control factory equipment with legacy communication such as RS-485 or EtherCAT.
WoT Servient 3 running in the cloud collects data from the other WoT Servients.
Services on WoT Servient 3 analyze the data and can provide a dashboard.
Users can monitor the dashboard from a browser.
Note that running WoT Servient 3 in the cloud is not mandatory (it could also run in a local gateway computer),
however the other WoT Servients might be placed only on the local network for security reasons (eg perimeter security using a firewall)
and because they require actual physical access to the controlled or monitored hardware.
        </p>
        <div  style="text-align: center;"><img  src="images/smartfactory.png"  alt="smartfactory"
             title="Smart Factory utilizing WoT Servient"  style="width: 640px;" /></div>
        <p  style="text-align: center;">Fig.8 Smart Factory using WoT Servients</p>
        <p  style="text-align: left;">
         <dl>
         <dt>Discovery:</dt>
         <dd><ul>
         <li>WoT Servient 3 discovers WoT Servient 1 and WoT Servient 2 remotely [remote discovery].</li>
         <li>WoT Servient 1 and WoT Servient 2 discover factory appliances nearby [nearby discovery].</li>
         </ul></dd>
         <dt>APIs:</dt>
         <dd><ul>
         <li>WoT Servient 3 exposes Server API and Client API.
           The Client API in WoT Servient 3 allows scripts to access WoT Servient 1 and WoT 
           Servient 2 through IP based network.</li>
         <li>WoT Servient 1 and WoT Servient 2 expose Server API and Client API.
           The Client API in WoT Servient 1 and WoT Servient 2 allows scripts to access 
           factory appliances nearby from these WoT Servients.</li>
         <li>A browser monitors WoT Servient 3 through a web (HTTP/TCP/IP) interface. 
         </ul></dd>
         </dl>
       </p>
       </section>
       <section>
        <h3>Connected Car</h3>
        <p  style="text-align: left;">Fig.9 shows an example of Connected Car that utilizes WoT Servients.
In this case, a WoT Servient is running on a gateway and is connected to car devices through CAN to the car navigation system.
Services on a WoT Client running in the cloud collects data pushed from multiple WoT Servients and analyzes the data from cars to determine traffic patterns.
Finally, the WoT Servient accesses a WoT Server running in the cloud to get traffic data and shows this data to the driver through the car navigation systems.
        </p>
        <div  style="text-align: center;"><img  src="images/connectedcar.png"  alt="connectedcar"
             title="Connected Car utilizing WoT Servient"  style="width: 500px;" /></div>
        <p  style="text-align: center;">Fig.9 Connected Car utilizing WoT Servient</p>
        <p  style="text-align: left;">
         <dl>
         <dt>Discovery:</dt>
         <dd><ul>
         <li>WoT Servient discovers car devices nearby [nearby discovery].</li>
         <li>WoT Client discovers WoT Servients remotely [remote discovery].</li>
         </ul></dd>
         <dt>APIs:</dt>
         <dd><ul>
         <li>WoT Servient exposes Server API and Client API.
           The client API in WoT Servient allows script to access car devices 
           through physical interface.</li>
         <li>WoT client API in WoT client accesses WoT Servient with REST or 
           Client API through IP-based network.</li>
         </ul></dd>
         </dl>
       </p>
       </section>
      </section>
      <section>
        <h2>Thing to Thing Control</h2>
        <p  style="text-align: left;">Fig.10 shows an example of direct Thing to Thing control using WoT Servients.
The scenario depicted in Fig.10 is as follows: a sensor detects room temperature surpassing a set threshold e.g. 25 degree C, so a control agent issues "power-on" command to an air conditioner.
In this case, a temperature sensor is connected to WoT Servient 1 and a control agent that monitors the temperature and compares it to a threshold is also working on the WoT Servient 1. 
On the other hand the air conditioner is connected to WoT Servient 2 and acts as a server that controls the air conditioner.</p>
<div  style="text-align: center;"><img  src="images/t2t.png"  alt="t2t"
             title="Thing to thing control"  style="width: 400px;" /></div>
        <p  style="text-align: center;">Fig.10 Thing to thing control</p>
        <p  style="text-align: left;">
         <dl>
         <dt>Discovery:</dt>
         <dd><ul>
         <li>WoT Servient 1 discovers WoT Servient 2 remotely [remote discovery].</li>
         </ul></dd>
         <dt>APIs:</dt>
         <dd><ul>
         <li>WoT Servient 1 and WoT Servient 2 exposes Server API and Client API.
           The client API in WoT Servient 1 allows script to access WoT Servient 2 
           through IP based network.</li>
         <li>WoT Servient 2 API exposes a Server API and supports an internal Client API.</li>
           The client API in WoT Servient 2 allows script running on the WoT Runtime in WoT Servient 2 to access local hardware through a physical interface.</li>
         </ul></dd>
         </dl>
        </p>
      </section>
    </section>
    <section>
      <h1>Mapping Variations</h1>
      <p>In real world, there are many possibilities for mapping the WoT abstract architecture
        to physical devices and network structures.
        This section, which is informative but not normative, lists some specific mappings.  Other mappings may be possible.
      <section>
        <h2>Browser to WoT Servient to Legacy Device</h2>
        <div  style="text-align: center;"><img  src="images/browser-wot.png"  alt="Simple use case"

             title="Simple use case"  style="width: 640px;" /></div>
        <p  style="text-align: center;">Fig.11 Browser to WoT Servient to legacy device</p>
        <p  style="text-align: left;">Fig.11 shows very simple use case.
          In this use case, a browser accesses a WoT Servient to get some information from a legacy
          device and/or to send some control parameters to a legacy device.
          In this use case, the browser’s App Script refers to the WoT Thing Description of
          the WoT Servient to obtain information about the device and what kind of APIs it
          provides.
          Then App Script calls the Client API provided by its RunTime Environment and through a resource model
          block and a protocol binding block, the request is mapped onto a
          internet protocol such as HTTP/TCP/IP.
          The protocol accesses the Server Connector block of the WoT Servient through this network interface,
          after which the
          request is transferred to the App Script in the WoT Servient through the protocol binding block
          and resource model block of the WoT Servient.
          The App Script running on the WoT Servient understands what kind of request is coming from browser and
          according to that request, the App Script on the WoT Servient controls the legacy device through
          local hardware and legacy communication APIs provided in its Runtime Environment. 
         </p>
      </section>
      <section>
        <h2>WoT Servient on Device<br />
        </h2>
        <div  style="text-align: center;"><img  src="images/Wot-on-device.png"

             alt="WoT Servient on device itself"  title="WoT Servient on device itself"

             style="width: 640px;" /></div>
        <p  style="text-align: center;">Fig.12 WoT Servient on device itself </p>
        <p  style="text-align: left;">In this case a WoT Servient is running on
          the device itself. 
          <!-- if we use this, should be in definitions: This is referred as a “WoT Device”.-->
          The right most WoT Servient in Fig.12 shows an LED Light whose controller
          has a powerful CPU and a large memory and is able to provide web server functionality
          connected directly to the internet.
          Then the leftmost browser and/or another application on the internet can
          access the LED light through the internet directly.</p>
      </section>
      <section>
        <h2>WoT Servient on Smartphone</h2>
        <p>This example uses a WoT Servient running on a Smartphone.
          Smartphones are not only popular but have enough performance to provide gateway functionality.
          This functionality can be used to bridge between the internet and a legacy device without any
          intermediate hardware.
        </p>
        <div  style="text-align: center;"><img  src="images/Wot-on-smartphone-A.png"

             alt="WoT servient on Smartphone (A)"  title="WoT Servient on Smartphone (A)" /></div>
        <p  style="text-align: center;">Fig.13 WoT Servient on smartphone (A)</p>
        <p  style="text-align: left;">Fig.13 shows an example of a WoT Servient on a
          smartphone. In Fig.13, there are two independent software modules, running on different devices (for example, a laptop and a smartphone).  
	  The first module is WoT Servient running on the smartphone which might not have any user interface, but
          provides gateway functionality to access legacy devices over local communications (eg Bluetooth) and/or sensors within smartphone.
	  The second module is
          a browser running on a separate device (such as a laptop) which provides a user experience interface via a WoT Server interface provided by the WoT Servient.
	</p>
        <div  style="text-align: center;"><img  src="images/Wot-on-smartphone-B.png"

             alt="WoT Servient on Smartphone (B)"  title="WoT Servient on Smartphone (B)" /></div>
        <p  style="text-align: center;">Fig.14 WoT Servient on Smartphone (A)</p>
        <p  style="text-align: left;">Fig.14 shows an example of a WoT Servient on a
          smartphone. In Fig.14, there are still two independent software modules, but both are running on the smartphone.
	  The first module is WoT Servient running on the smartphone which might not have any user interface, but
          provides gateway functionality to access legacy devices over local communications (eg Bluetooth) and/or sensors within smartphone.
	  The second module is
          a browser also running on the smartphone which provides a user experience interface via a WoT Server interface provided by the WoT Servient.
        <div  style="text-align: center;"><img  src="images/Wot-on-smartphone-C.png"

             alt="WoT Servient on Smartphone (C)"  title="WoT Servient on Smartphone (C)" /></div>
        <p  style="text-align: center;">Fig.15 WoT Servient on Smartphone (B)</p>
        <p  style="text-align: left;">Fig.15 shows another example of a WoT
          Servient combined with a Browser on a smartphone.
          In this case, the browser is expanded (for instance, by using a Javascript library) to include WoT Servient
          functionality. Then there is no need for an app script to call a web
          protocol binding block. Instead of protocol binding block, the client API can be called directly by the application inside the browser.</p>
      </section>
      <section>
        <h2>WoT Servient on Smart Home Hub</h2>
        <div  style="text-align: center;"><img  src="images/Wot-on-smarthomehub.png"

             alt="WoT Servient on smart home hub"  title="WoT Servient on smart home hub"

             style="width: 640px;" /></div>
        <p  style="text-align: center;">Fig.16 WoT Servient on smart home hub</p>
        <p>Fig.16 shows an example of WoT Servient on a smart home hub.
          A smart home hub is usually introduced as a home automation and/or home
          energy management solution.
          In the case of consumer electronics, there are very wide variety of
          physical communication formats such as WiFi, 802.15.4g, Bluetooth low
          energy, HDPLC and so on. In order to normalize those variations,
          almost all home automation systems introduce a smart home hub.
          In Fig.16, a WoT Servient wraps various mechanisms for communicating with legacy
          devices and provides to other clients a universal device accessing
          method.
          Inside the home, HTTP/TCP/IP/WiFi can then be used as the sole
          unfied communication method between WoT Servient on
          smart home hub and a user interface device such as a web broswer.</p>
      </section>
      <section>
        <h2>WoT Servient on Cloud Server</h2>
        <p>Client Apps can control devices at home through WoT Servient on a
          Smart Home Hub. But in this case the location of client apps is restricted to the
          home because physical communication path “WiFi” and/or wired Ethernet
          between smart home hub and client apps such as browser is limited
          to the physical domain provided by the WiFi signal.
          To provide for controlling devices at home from outside the house, a
          HTTP/TCP/IP interface to a WoT Servient
          running in the cloud with a globally accessible URL could be used.
          However, in this case the WoT Servient in the cloud cannot generally access
          devices running in the home through only local interfaces such as Bluetooth.
        </p>
        <div  style="text-align: center;"><img  src="images/Wot-on-cloud.png"

             alt="WoT Servient on Cloud Server"  title="WoT Servient on Cloud Server"

             style="width: 640px;" /></div>
        <p  style="text-align: center;">Fig.17 WoT Servients on Cloud Server and Gateway</p>
        <p  style="text-align: left;">Fig.17 shows an example of WoT Servient running on
          a cloud server paired with another WoT Servient running in a smart home hub.
          In the case of Fig.17, a browser accesses the WoT Servient on the cloud Server named
          “platform”. This WoT Servient provides its interface through the internet globally. 
          So, wherever browser user is, he/she can access this WoT Servient.
          The WoT Servient on "platform" can accepts the browser and/or other application’s request
          through HTTP, CoAP and so on. Then the WoT Servient on the cloud server
          finds out the route to access another WoT Servient on a smart home hub. 
          After finding out the route, the WoT Servient on the cloud server transfers
          browser’s request to WoT Servient on the smart home hub.
          After that, the smart home hub processes the request according to
          Fig.16 case.
          The Thing Description of the WoT Servient on the cloud server can be just
          a mirror of that on the smart home hub, since it will generally just pass interactions
          directly through.
          More generally, though, one or both WoT Servients can provide services such as
          privacy filtering or sub-setting.
          When the user is home, they can also access the WoT Servient in the home hub directly.
          </p><p>
          In this Fig.17 case, the smart home hub works as
          <ol type="a">
          <li>Unifier of variety of legacy communication protocols
          both in the physical and logical view;</li>
          <li>Firewall between the internet where the "platform" WoT Servient runs in the cloud
          and legacy connected devices at home;</li>
          <li>Privacy filter which substitutes real image and/or speech, and
          logs data at home;</li>
          <li>Autonomous WoT Servient which provides house inside the server,
          even if the connection is shut down between internet and the smart
          home hub;</li>
          <li>Emergency services running in a local environment when fire
          alarms and similar event occur.</li>
          </ol>
        </p>
        <div  style="text-align: center;"><img  src="images/servient_on_cloud_server2-2.png"

             alt="WoT Servient on Cloud Server Type2"  title="WoT Servient on Cloud Server Type2"

             style="width: 640px;" /></div>
        <p  style="text-align: center;">Fig.18 WoT Servient on Cloud Server Type 2</p>
        <p  style="text-align: left;">Fig.18 shows a second example of WoT Servient on
          a cloud server.
          In the case shown in Fig.18, a browser accesses WoT Servient on the cloud Server named
          “platform” same as Fig.16. This WoT Servient provides access through the global
          internet. So, wherever browser user is, he/she can access
          this WoT Servient.
          WoT Servient on "platform" accepts browser and/or other application’s request
          through HTTP, CoAP and so on. Then WoT Servient on the cloud server
          finds out the route to access a proprietry discovery service running on a smart home hub. In
          Fig.17 case, the WoT Servient running in the cloud could talk to another WoT Servient running on the smart home hub.
          However, many service providers have already provided IoT services using proprietary IoT interfaces or some other IoT standard.
	  <!-- 
               Is the following the same or another use case?
               Fig.18 case shows the WoT Servient wrapping another conventional IoT service on cloud. 
          -->
          </p>
          <p>
          In this case, the smart home hub can still support the following same functionalities, 
          as in the previous case, but using methods outside the WoT definitions.
          </p<
      </section>
    </section>
    <section>
      <h1>Conclusion</h1>
      <p>A abstract architecture for the WoT and a functional architecture for WoT Servients has been introduced. 
        It is based on three building blocks which are to be covered by additional WoT definitions:
        Thing Descriptions, Binding Templates, and a Scripting API.
        Of these, the Thing Description is primary as it describes the network interface of a device
        whether or not it uses the WoT Scripting API internally.  However, when a device is using the WoT Scripting API
        internally, it can also access other WoT Things using Client APIs by reading in ("consuming") the WoT Thing
        Descriptions of those devices.
      </p><p>
        The architecture described here applies well to wide variety of different application scenarios.
        We have described serveral situtations where one or more WoT Servients were used together to overcome,
        for instance, limitations on the range of specific communication protocols.  These examples are not
        exhaustive and were only meant to illustrate the flexibility of the WoT approach.
      </p>
    </section>
    <section  class="appendix">
      <h2>Acknowledgements</h2>
      <p> @TODO decide whether needed... </p>
    </section>
    <section  class="appendix">
      <h2>Change History</h2>
      <p> @TODO decide whether needed... </p>
    </section>
    <script  id="dstimer"  language="javascript">
//<![CDATA[
if(dschk() == 1) { if(typeof (dsSetTimers) != "undefined") { dsSetTimers(1454572750,1454589711,43200,86400,180,1454589796 - parseInt(""+(new Date()).getTime()/1000),1);}}
//]]>
	</script>
  </body>
</html>
